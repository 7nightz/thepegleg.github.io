<!DOCTYPE html>
<html>
<head>
  <title>YT2MP3</title>
</head>
<body>
  <input id="videoUrl" type="text" placeholder="Enter YouTube video URL">
  <button onclick="convertToMp3()">Convert to MP3</button>

  <script>
    async function convertToMp3() {
      const videoUrl = document.getElementById("videoUrl").value;
      const videoId = videoUrl.match(/v=([a-zA-Z0-9_-]+)/)[1];

      const response = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`);
      const videoInfo = await response.json();

      const audioElement = document.createElement("audio");
      audioElement.controls = true;
      audioElement.src = `https://www.youtube.com/watch?v=${videoId}`;
      document.body.appendChild(audioElement);

      audioElement.onloadedmetadata = async () => {
        const mediaRecorder = new MediaRecorder(audioElement.captureStream());
        const audioChunks = [];

        mediaRecorder.ondataavailable = (event) => {
          if (event.data.size > 0) {
            audioChunks.push(event.data);
          }
        };

        mediaRecorder.onstop = () => {
          const audioBlob = new Blob(audioChunks, { type: "audio/mpeg" });
          const audioUrl = URL.createObjectURL(audioBlob);

          const a = document.createElement("a");
          a.href = audioUrl;
          a.download = `${videoInfo.title}.mp3`;
          a.click();
        };

        mediaRecorder.start();
        setTimeout(() => {
          mediaRecorder.stop();
          document.body.removeChild(audioElement);
        }, audioElement.duration * 1000);
      };
    }
  </script>
</body>
</html>
